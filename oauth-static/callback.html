<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex">
    <title>Notion認証中 - Raku Raku Notion</title>
</head>
<body>
    <script>
        // 拡張機能ID（デプロイ時に設定してください）
        // Chrome Web Storeで公開する場合は、公開後のIDに変更してください
        const EXTENSION_ID = 'YOUR_EXTENSION_ID';

        var urlParams = new URLSearchParams(window.location.search);
        var code = urlParams.get('code');
        var state = urlParams.get('state');
        var error = urlParams.get('error');

        // エラーまたはパラメータ不足の場合はエラーページへ
        if (error || !code || !state) {
            var errorMessage = error || 'パラメータが不足しています';
            window.location.replace('./error.html?reason=' + encodeURIComponent(errorMessage));
        }
        // 拡張機能IDが未設定の場合
        else if (EXTENSION_ID === 'YOUR_EXTENSION_ID') {
            window.location.replace('./error.html?reason=' + encodeURIComponent('拡張機能IDが設定されていません'));
        }
        // 正常な場合は拡張機能にリダイレクト
        else {
            var extensionUrl = 'chrome-extension://' + EXTENSION_ID + '/oauth-callback.html?code=' + encodeURIComponent(code) + '&state=' + encodeURIComponent(state);
            window.location.replace(extensionUrl);
        }
    </script>
</body>
</html>
